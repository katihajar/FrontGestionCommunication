<ng-template [ngIf]="this.spinner ">
    <div class="spinner-container">
      <p-progressSpinner styleClass="spinner" strokeWidth="4" [fill]="'#ffffff'"></p-progressSpinner>
    </div>
  </ng-template>

<div [ngClass]="{'blur': this.spinner}"  class="container-fluid page" style="background-color: white">
    <div class="d-flex page__box p-3">Ajouter un Changement</div>
    <div class="page__content shadow p-3 position-relative card align-items-center">
            <div class="col-12" style="margin: 2%">
                <span class="p-input-icon-left" style="margin-left: 3%" [style]="{ width: '22%' }">
                    <label for="basic3"
                        style="font-size: 15px;font-family: Arial, Helvetica, sans-serif;">Titre<span style="color: red;">*</span></label>
                    <input inputId="basic3" style="padding-left: 0.8rem; " required [style]="{ width: '100%' }"
                        type="text" pInputText placeholder="Entré le Titre du Changement"
                        [(ngModel)]="this.AddChangement.titre" />

                </span>
                <span class="p-input-icon-left" style="margin-left: 2%" [style]="{ width: '22%' }">
                    <label for="basic4" style="font-size: 15px;font-family: Arial, Helvetica, sans-serif;">N°
                        Version Application<span style="color: red;" *ngIf="this.AddChangement.application.charteChangement == 'charte Changement Monetics'">*</span></label>
                    <input inputId="basic4" required style="padding-left: 0.8rem; " [style]="{ width: '100%' }"
                        type="text" pInputText placeholder="Entré le numero d'incident"
                        [(ngModel)]="this.AddChangement.version" />

                </span>
                <span class="p-input-icon-left" style="margin-left: 2%" [style]="{ width: '22%' }">
                    <label for="basic1" style="font-size: 15px;font-family: Arial, Helvetica, sans-serif;">Date
                        Début<span style="color: red;">*</span></label>
                    <p-calendar inputId="basic1" [(ngModel)]="date2" [showTime]="true" [style]="{ width: '100%' }"
                    appendTo="body"  [(ngModel)]="this.AddChangement.dateDebut"></p-calendar>

                </span>
                <span class="p-input-icon-left" style="margin-left: 2%" [style]="{ width: '22%' }">
                    <label for="basic2" style="font-size: 15px;font-family: Arial, Helvetica, sans-serif;">Date
                        Fin<span style="color: red;">*</span></label>
                    <p-calendar inputId="basic2" [(ngModel)]="date3" [showTime]="true" [style]="{ width: '100%' }"
                    appendTo="body" [(ngModel)]="this.AddChangement.dateFin"></p-calendar>

                </span>

            </div>
            <div class="col-12" style="margin-bottom: 2%;">
                <span class="p-input-icon-left" style="margin-left: 3%" [style]="{ width: '46%' }">
                    <label for="basic5"
                        style="font-size: 15px;font-family: Arial, Helvetica, sans-serif;">Détail<span style="color: red;">*</span></label>
                    <textarea id="basic5" style="padding-left: 0.8rem; " required [style]="{ width: '100%' }"
                        type="text" pInputTextarea placeholder="Entré le Detail"
                        [(ngModel)]="this.AddChangement.detail"></textarea>

                </span>
                <span class="p-input-icon-left" style="margin-left: 2%" [style]="{ width: '46%' }">
                    <label for="basic5"
                        style="font-size: 15px;font-family: Arial, Helvetica, sans-serif;">Impact Métier<span style="color: red;">*</span></label>
                    <textarea id="basic5" style="padding-left: 0.8rem; " required [style]="{ width: '100%' }"
                        type="text" pInputTextarea placeholder="Entré l'Impact Métier"
                        [(ngModel)]="this.AddChangement.impactMetier"></textarea>

                </span>
         
            </div>

            <div *ngIf="this.AddChangement.application.charteChangement == 'charte Changement Monetics'"  class="card align-items-center" style="width: 97%; margin-left: 1%;margin-bottom: 2%;background-color: rgb(241, 241, 241);">
                <h1 style="margin: 3%;color: black;">Ajouter le Contenu<span style="color: red;">*</span></h1>
                <div class="col-12 text-center" style="margin-bottom: 2%">
                    <span class="p-input-icon-left" style="margin-left: 2%" [style]="{ width: '45%' }">
                        <label for="basic6"
                            style="float: left;font-size: 15px;font-family: Arial, Helvetica, sans-serif;margin-left: 3%">N° Ticket
                            </label>
                        <input id="basic6" required style="padding-left: 0.8rem; " [style]="{ width: '100%' }"
                            type="text" pInputText placeholder="Entré le numero"
                            [(ngModel)]="this.Contenu.titre" />
                    </span>
                </div>
                    <div class="col-12 text-center" style="margin-bottom: 2%">
                    <span class="p-input-icon-left" style="margin-left: 10%" [style]="{ width: '70%' }">
                        <label
                            style="float: left;font-size: 15px;font-family: Arial, Helvetica, sans-serif;margin-left: 2%">Description</label>
                        <textarea style="padding-left: 0.8rem; " required [style]="{ width: '100%' }"
                            type="text" pInputTextarea placeholder="Entré la Nom description"
                            [(ngModel)]="this.Contenu.description"></textarea>

                    </span>
                    <button style="margin-left: 1%" pButton pRipple type="button" icon="pi pi-plus"
                        (click)="AddContenu()" class="p-button-rounded p-button-success"></button>
                </div>
            
                <div class="col-12" style="margin: 2%">
                    <p-table class="table" [value]="this.ListContenu" dataKey="id" [rows]="10"
                        [showCurrentPageReport]="true" [paginator]="true"
                        currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries">
                        <ng-template pTemplate="header">
                            <tr>
                                <th>
                                    <div class="flex justify-content-center align-items-center">
                                        N° Ticket
                                    </div>
                                </th>
                                <th>
                                    <div class="flex justify-content-center align-items-center">
                                        description
                                    </div>
                                </th>
                                <th>
                                    <div class="flex justify-content-center align-items-center">
                                        supprimer
                                    </div>
                                </th>
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="body" let-cont>
                            <tr>
                                <td>
                                    {{ cont.titre }}
                                </td>


                                <td>
                                    {{ cont.description }}
                                </td>
                                <td>
                                    <button pButton pRipple type="button" style="font-size: larger" (click)="removeListContenu(cont)"
                                        icon="pi pi-times" class="p-button-rounded p-button-danger"></button>
                                </td>
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="emptymessage">
                            <tr>
                                <td colspan="3">aucun contenu n'a été ajoué.</td>
                            </tr>
                        </ng-template>
                    </p-table>
                </div>
            </div>
            <div class="col-12" style="margin-bottom: 2%; margin-top: 2%;">
                <button pButton pRipple (click)="showCharte()" type="button" label="Visualiser la charte" style=" float: left;margin-left: 2%;" class="p-button-raised p-button-help"></button>
                <button pButton pRipple (click)="SendAndSaveChange()" [disabled]="isSubmitDisabled()" style=" float: right;margin-right: 2%;" type="button" label="Soumettre" class="p-button-raised"></button>
            </div>
        </div>
    </div>
<app-charte-changement-fr [ngClass]="{'blur': this.spinner}"  *ngIf="charteChangeFr"></app-charte-changement-fr>
<app-charte-operation-fr [ngClass]="{'blur': this.spinner}"  *ngIf="charteOperationFr"></app-charte-operation-fr>
